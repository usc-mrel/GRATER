% Use this script to plot some examples of RF pulses!
clc; clear all; close all;
addpath('./useful_functions')
exampnum = 2;
%% Some examples of things you can plot...
% Change which experiment data to load & which RF pulses you want to view
% Experiment data & RF parameters specified in last 3 sections of Readme.m

switch exampnum
    case 1
        % view RF pulse 1 of experiment 1 
        load('./Exp_1/Exp1p_grater.mat')
        load('./Exp_1/Exp1p_reference.mat')
        load('./Exp_1/Exp1r_programmed.mat')
        
        rfnum = 1;  % 2-band, TBW = 2 RF pulse
    case 2
        % view RF pulse 16 from experiment 1
        load('./Exp_1/Exp1p_grater.mat')
        load('./Exp_1/Exp1p_reference.mat')
        load('./Exp_1/Exp1r_programmed.mat')
        
        rfnum = 16; % 5-band, TBW = 8 RF pulse
    case 3
end
%%
programmed = Exp1r_programmed;
ref = Exp1p_reference;
GRATER = Exp1p_grater;
npts = size(programmed,2);

tms = linspace(0,2,npts);
figure();
% view programmed, reference, and GRATER waveforms togther
plot(tms,programmed(rfnum,:)/max(abs(programmed(rfnum,:))),'k',...
    tms,ref(rfnum,:)/max(abs(ref(rfnum,:))),'r',...
    tms,GRATER(rfnum,:)/max(abs(GRATER(rfnum,:))),'b--',...
    'LineWidth',2)
set(gca,'FontSize',12,'FontWeight','bold');
axis tight; grid on;
xlabel('ms'); ylabel('a.u.');
legend('programmed','reference','GRATER');

NRMSErg = nrmse(ref,GRATER);
disp(['NRMSE between reference and GRATER = ' round(100*num2str(NRMSErg) '.'])

